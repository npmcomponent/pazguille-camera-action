(function(a){"use strict";function b(){this.collection={},this.maxListeners=10}b.prototype.addListener=function(a,b,c){if(void 0===a)throw Error('jvent - "addListener(event, listener)": It should receive an event.');if(void 0===b)throw Error('jvent - "addListener(event, listener)": It should receive a listener function.');var d=this.collection;if(b.once=c||!1,void 0===d[a]&&(d[a]=[]),d[a].length+1>this.maxListeners&&0!==this.maxListeners)throw Error("Warning: So many listeners for an event.");return d[a].push(b),this.emit("newListener"),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(a,b){return this.on(a,b,!0),this},b.prototype.removeListener=function(a,b){if(void 0===a)throw Error('jvent - "removeListener(event, listener)": It should receive an event.');if(void 0===b)throw Error('jvent - "removeListener(event, listener)": It should receive a listener function.');var e,c=this.collection[a],d=0;if(void 0!==c)for(e=c.length,d;e>d;d+=1)if(c[d]===b){c.splice(d,1);break}return this},b.prototype.off=b.prototype.removeListener,b.prototype.removeAllListeners=function(a){if(void 0===a)throw Error('jvent - "removeAllListeners(event)": It should receive an event.');return delete this.collection[a],this},b.prototype.setMaxListeners=function(a){if(isNaN(a))throw Error('jvent - "setMaxListeners(n)": It should receive a number.');return this.maxListeners=a,this},b.prototype.listeners=function(a){if(void 0===a)throw Error('jvent - "listeners(event)": It should receive an event.');return this.collection[a]},b.prototype.emit=function(){var c,e,a=Array.prototype.slice.call(arguments,0),b=a.shift(),d=0;if(void 0===b)throw Error('jvent - "emit(event)": It should receive an event.');if("string"==typeof b&&(b={type:b}),b.target||(b.target=this),void 0!==this.collection[b.type])for(c=this.collection[b.type],e=c.length,d;e>d;d+=1)c[d].apply(this,a),c[d].once&&(this.off(b.type,c[d]),e-=1,d-=1);return this},"function"==typeof a.define&&void 0!==a.define.amd?a.define("Jvent",[],function(){return b}):"undefined"!=typeof module&&void 0!==module.exports?module.exports=b:a.Jvent=a.EventEmitter=b})(this),function(a){"use strict";function f(a,b){return this.init(a,b),this}var b=a.navigator,c=a.document,d=a.URL||a.webkitURL||a.mozURL||a.msURL,e={mandatory:{minWidth:"1280",minHeight:"720"}};b.getUserMedia=b.getUserMedia||b.webkitGetUserMedia||b.mozGetUserMedia||b.msGetUserMedia,f.prototype=new Jvent,f.prototype.init=function(a,b){return b=b||{},b.hd=void 0!==b.hd?b.hd:!1,b.width=b.width||320,b.height=b.height||240,this.el=a,this.width=b.width,this.height=b.height,this._constraints=b.hd?e:!0,this._canvas=c.createElement("canvas"),this._createVideo(),this},f.prototype._createVideo=function(){var a=c.createElement("video");return a.autoplay="autoplay",a.width=this.width,a.height=this.height,this._video=a,this},f.prototype.action=function(){var a=this;return void 0!==this._stream?this._video.play():(this.el.appendChild(this._video),b.getUserMedia({video:this._constraints,audio:!1},function(b){a._success(b)},a._fail)),this},f.prototype._success=function(a){return this._video.src=d?d.createObjectURL(a):a,this._video.play(),this._stream=a,this.emit("action"),this},f.prototype._fail=function(){return this.emit("fail"),this},f.prototype.pause=function(){return this._video.pause(),this.emit("pause"),this},f.prototype.cut=function(){return this._video.src="",this._stream.stop(),this._stream=void 0,this.el.removeChild(this._video),this.emit("cut"),this},f.prototype.takePhoto=function(a){var b;return a=a||{},a.type=a.type||"image/png",a.width=this._canvas.width=a.width||this.width,a.height=this._canvas.height=a.height||this.height,a.download=void 0!==a.download?a.download:!1,this._canvas.getContext("2d").drawImage(this._video,0,0,a.width,a.height),b=this._canvas.toDataURL(a.type,a.jpegquality),a.download&&(c.location.href=b.replace(a.type,"image/octet-stream")),this.emit("photo",b),b},"function"==typeof a.define&&void 0!==a.define.amd?a.define("camera",[],function(){return f}):"undefined"!=typeof module&&void 0!==module.exports?module.exports=f:a.Camera=f}(this);